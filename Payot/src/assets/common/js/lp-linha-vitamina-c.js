let i = [{
        'id': '71850900',
        'name': 'Sabonete Detox',
        'img_thumb': '<li><img src="https://payottatix.vteximg.com.br/arquivos/1_Sabonete-thumb.jpg" alt="Imagem Sabonete Detox" /></li><li><img src="https://payottatix.vteximg.com.br/arquivos/2_Sabonete-thumb.jpg" alt="Imagem Sabonete Detox" /></li><li><img src="https://img.youtube.com/vi/v6xJRwLO7I4/default.jpg" alt="Imagem Sabonete Detox" data-video="v6xJRwLO7I4"/></li><li><img src="https://img.youtube.com/vi/nqopCC8s6gg/default.jpg" alt="Imagem Sabonete Detox" data-video="nqopCC8s6gg"/></li><li><img src="https://img.youtube.com/vi/FN6amrSZiuQ/default.jpg" alt="Imagem Sabonete Detox" data-video="FN6amrSZiuQ"/></li>',
        'img_principal': '<img src="https://payottatix.vteximg.com.br/arquivos/1_Sabonete-thumb.jpg" alt="Imagem Sabonete Detox" />',
        'short_description': '<p>Além de higienizar a pele colabora para o aumento e permanência da hidratação cutânea, complementando os benefícios antirradicais livres da VITAMINA C.</p>',
        'beneficios': '<img src="https://payottatix.vteximg.com.br/arquivos/new-infos-vita-c.png" alt="Beneficios Sabonete Detox" />'
    },
    {
        'id': '71850923',
        'name': 'Tônico Facial',
        'img_thumb': '<li><img src="https://payottatix.vteximg.com.br/arquivos/1_Tonico-thumb.jpg" alt="Imagem Tônico" /></li><li><img src="https://payottatix.vteximg.com.br/arquivos/2_Tonico-thumb.jpg" alt="Imagem Tônico" /></li><li><img src="https://payottatix.vteximg.com.br/arquivos/3_Tonico-thumb.jpg" alt="Imagem Tônico" /></li><li><img src="https://img.youtube.com/vi/v6xJRwLO7I4/default.jpg" alt="Imagem Tônico" data-video="v6xJRwLO7I4"/></li><li><img src="https://img.youtube.com/vi/FN6amrSZiuQ/default.jpg" alt="Imagem Tônico" data-video="FN6amrSZiuQ"/></li>',
        'img_principal': '<img src="https://payottatix.vteximg.com.br/arquivos/1_Tonico-thumb.jpg" alt="Imagem Tônico" />',
        'short_description': '<p>Revitaliza, equilibra a pele com uma sensação imediata de refrescância, complementando os benefícios antirradicais livres da VITAMINA C.</p>',
        'beneficios': '<img src="https://payottatix.vteximg.com.br/arquivos/new-infos-vita-c.png" alt="Beneficios Tônico Facial" />'
    },
    {
        'id': '57117951',
        'name': 'Complexo de Vitamina C',
        'img_thumb': '<li><img src="https://payottatix.vteximg.com.br/arquivos/1_Complexo-thumb.jpg" alt="Imagem Complexo Vitamina C" /></li><li><img src="https://payottatix.vteximg.com.br/arquivos/2_Complexo-thumb.jpg" alt="Imagem Complexo Vitamina C" /></li><li><img src="https://payottatix.vteximg.com.br/arquivos/3_Complexo-thumb.jpg" alt="Imagem Complexo Vitamina C" /></li><li><img src="https://img.youtube.com/vi/6bfQ57rN8xQ/default.jpg" alt="Imagem Complexo Vitamina C" data-video="6bfQ57rN8xQ"/></li><li><img src="https://img.youtube.com/vi/FN6amrSZiuQ/default.jpg" alt="Imagem Complexo Vitamina C" data-video="FN6amrSZiuQ"/></li>',
        'img_principal': '<img src="https://payottatix.vteximg.com.br/arquivos/1_Complexo-thumb.jpg" alt="Imagem Complexo Vitamina C" />',
        'short_description': '<p>O Complexo de Vitamina C tem aplicação tópica, com poder de penetração cutânea que promove um efeito hidratante, revitalizante e reparador na epiderme. Ele ajuda a estimular a formação do colágeno naturalmente produzido pela pele, restitui sua elasticidade, frescor e juventude. Além disso, ajuda a combater a ação dos radicais livres e auxilia a atenuar rugas superficiais. A pele torna-se lisa, firme e luminosa.</p>',
        'beneficios': '<img src="https://payottatix.vteximg.com.br/arquivos/new-infos-vita-c.png" alt="Imagem Complexo Vitamina C" />'
    },
    {
        'id': '71850883',
        'name': 'Serum área dos olhos',
        'img_thumb': '<li><img src="https://payottatix.vteximg.com.br/arquivos/ids/155851-800-800/Area-dos-olhos.png" alt="Imagem Serum área dos olhos" /></li>',
        'img_principal': '<img src="https://payottatix.vteximg.com.br/arquivos/ids/155851-800-800/Area-dos-olhos.png" alt="Imagem Serum área dos olhos" />',
        'short_description': '<p>Com efeito lifting instantâneo, suavisa as linhas de expressão e remodela o olhar imediatamente, complementando os benefícios antirradicais livres da VITAMINA C.</p>',
        'beneficios': '<img src="https://payottatix.vteximg.com.br/arquivos/new-infos-vita-c.png" alt="Imagem Serum área dos olhos" />'
    },
    {
        'id': '71850946',
        'name': 'Hidratante corporal',
        'img_thumb': '<li><img src="https://payottatix.vteximg.com.br/arquivos/ids/155854-800-800/Hidratante_Corporal_Nutritivo__952.jpg" alt="Imagem Hidratante corporal" /></li>',
        'img_principal': '<img src="https://payottatix.vteximg.com.br/arquivos/ids/155854-800-800/Hidratante_Corporal_Nutritivo__952.jpg" alt="Imagem Hidratante corporal" />',
        'short_description': '<p>Máxima hidratação 24 horas, rapidamente absorvido pela pele, estimula a proteção e manutenção do colágeno, complementando os benefícios antirradicais livres da VITAMINA C.</p>',
        'beneficios': '<img src="https://payottatix.vteximg.com.br/arquivos/new-infos-vita-c.png" alt="Imagem Hidratante corporal" />'
    },
    {
        'id': '71850947',
        'name': 'KIT FAMÍLIA VITAMINA C',
        'img_thumb': '<li><img src="https://payottatix.vteximg.com.br/arquivos/ids/157077_2/vitaminaC--2-.png" alt="familia-vitaminac"></li><li><img src="https://img.youtube.com/vi/7aNrQb3ayLM/default.jpg" alt="Imagem familia-vitaminac" data-video="7aNrQb3ayLM"/></li>',
        'img_principal': '<img src="https://payottatix.vteximg.com.br/arquivos/ids/157077_2/vitaminaC--2-.png" alt="Imagem familia-vitaminac">',
        'short_description': '<p>A Vitamina C da Payot Brasil é um sucesso, pois além de clarear a pele, promove a síntese de colágeno e previne aquelas ruguinhas indesejadas! Com alto poder antioxidante, devolve a firmeza e promove a hidratação da pele!</p>',
        'beneficios': '<img src="https://payottatix.vteximg.com.br/arquivos/new-infos-vita-c.png" alt="Imagem Hidratante corporal" />'
    }
]
$(document).ready(function(){
    for(var i = 1; 20 >= i; i++){
        $('.sel-qtd').append('<option value="'+i+'">'+i+'</option>')
    }
    let arrayProducts = []
    let price, listPrice, vlrParcelas;
    let qtdParcelas = 0
    var settings = {
        "url": "/api/catalog_system/pub/products/search/?fq=skuId:71850900",
        "method": "GET"
    };
    
    $.ajax(settings).done(function (response) {
        arrayProducts = response;
        $('#tabs-descricao p').html(arrayProducts[0].description)
        $('#tabs-lista p').html(arrayProducts[0].Composição)
        $('#tabs-uso p').html(arrayProducts[0]["Modo de Uso"])

        $('#idSku').val(arrayProducts[0].items[0].itemId)
        $('#___rc-p-id').val(arrayProducts[0].items[0].itemId)
        $('#___rc-p-sku-ids').val(arrayProducts[0].items[0].itemId)
        
        price = response[0].items[0].sellers[0].commertialOffer.Price
        listPrice = response[0].items[0].sellers[0].commertialOffer.ListPrice
        $('.preco-por').html('Por R$ ' + price.toFixed(2).replace('.',','))
        if(price < listPrice){
            $('.preco-de').html('De R$ ' + listPrice.toFixed(2).replace('.',','))
        }else{
            $('.preco-de').html(' ')
        }


        for(var p = 0; arrayProducts[0].items[0].sellers[0].commertialOffer.Installments.length > p; p++){
           if(arrayProducts[0].items[0].sellers[0].commertialOffer.Installments[p].NumberOfInstallments > 1){
               qtdParcelas = arrayProducts[0].items[0].sellers[0].commertialOffer.Installments[p].TotalValuePlusInterestRate;
           }else{
               qtdParcelas = 1;
           }
        }
        vlrParcelas = (price/qtdParcelas)
        $('.parcelamento').html(qtdParcelas +' x ' + vlrParcelas.toFixed(2).replace('.',','))

    });

    
    $('.add-mais').live('click', function(){
        var qtd = $('#qtd').val();
        qtd = (parseInt(qtd) + 1)
        $('#qtd').val(qtd)
    })
    $('.add-menos').live('click', function(){
        var qtd = $('#qtd').val();
        qtd = (parseInt(qtd) - 1)
        if(qtd >= 1){
            $('#qtd').val(qtd)
        }
    })

    $('.miniaturas img').live('click', function(){
        if($('body').hasClass('mobile')){
            if($(this).attr('data-video')){
                var videoId = $(this).attr('data-video');
                var url = `https://m.youtube.com/watch?v=${videoId}`
                window.open(url, '_blank').focus();
            }
        }else{
            if($(this).attr('data-video')){
                var videoId = $(this).attr('data-video');
                var htmlVideo = `
                <iframe class='iframe-video'
                width="528"
                height="296"
                src="https://www.youtube.com/embed/${videoId}"
                frameborder="0"
                allow="accelerometer; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen>
                </iframe>`;
                $('.img-principal').html('')
                $('.img-principal').html(htmlVideo) 
            }else{
                var srcImg = $(this).attr('src')
                $('.img-principal').html('')
                $('.img-principal').html(`<img src="${srcImg}" alt="Imagem Produto" />`) 
                
            }
        }
    })

    $('.buy-buttom-lp-linha-vit-c').live('click', function(){
        var qtd = $('#qtd').val()
        var id = $('#idSku').val()
        vtexjs.checkout.addToCart([{
            id: id, 
            quantity: qtd, 
            seller: 1
        }], null, jssalesChannel).done(function(orderForm) {
            console.log(orderForm)
            $('body').addClass('no--scroll')
            $('.j-minicart__content').addClass('is--active')
        });
    })

    $('.sel-product-list li').live('click', function(){
        $('.ui-tabs-nav li:first-child a').trigger('click')
        $('.sel-product-list li').removeClass('active')
        $(this).addClass('active')
        var idSku = $(this).attr('id')
        idSku = idSku.replace('item-','').replace(' active','')
        getSku(idSku)
    })
    
}) /* end ready */

function getSku(id){
    for(var p = 0; i.length > p; p++){
        if(i[p].id == id){
            $('#idSku').val(id)
            $('#___rc-p-id').val(id)
            $('#___rc-p-sku-ids').val(id)
            $('.miniaturas ul').html(i[p].img_thumb)
            $('.img-principal').html(i[p].img_principal)
            $('.title-product').html(i[p].name)
            $('.box-teste').html(i[p].short_description)
            $('.beneficios-linha-vit-c').html(i[p].beneficios)
        }
    }

    var apiUrl = '/api/catalog_system/pub/products/search/?fq=skuId:'+id;
    fetch(apiUrl)
    .then((response) => response.json())
    .then((dataSku) => {
        $('.lp-linha-vitamina-c .col-info-product .preco-por').html ('Por R$ ' + dataSku[0].items[0].sellers[0].commertialOffer.Price.toFixed(2).replace('.',','))
        $('#tabs-descricao p').html(dataSku[0].description)
        $('#tabs-lista p').html(dataSku[0].Composição)
        $('#tabs-uso p').html(dataSku[0]["Modo de Uso"])
        
    });
}

$(document).ready(function(){
    setInterval(function(){
        $('body.lp-linha-vitamina-c .yv-qa h3.j-shelf__title span').text('Tem alguma dúvida?');
        $('label.yv-qa-main-ask').text('Faça uma pergunta ao lojista ou a outros compradores relacionada ao produto.');
        $('body.lp-linha-vitamina-c div#yv-reviews .yv-bootstrap.yv-main h3.j-shelf__title span').text('AVALIAÇÃO DOS CLIENTES');
    },1000)
    $('.lp-linha-vitamina-c .sel-product-list ul').slick({
        dots: false,
        infinite: false,
        speed: 300,
        slidesToShow: 5,
        slidesToScroll: 1,
        prevArrow: '<div class="icon-banners-left"></div>',
        nextArrow: '<div class="icon-banners-right"></div>',
      });
});
